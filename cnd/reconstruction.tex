\section{Reconstruction}\label{sec_rec}
The reconstruction of the CND is done in three steps:
\begin{itemize}
\item{the reconstruction of the deposited energy;}
\item{the reconstruction of the time and position of the hit in the paddle;}
\item{the matching of CND hits with tracks coming from the interaction vertex.}
\end{itemize}

\subsection{Energy reconstruction}
For hits in the left paddle, the two associated ADCs can be written as:
\begin{equation}
\label{eq_rec_3}
ADC_{\rm{L}}=\frac{E_{\rm{L}}}{E_0}\cdot MIP_{\rm{D}}\cdot e^{\frac{-z}{A_{\rm{L}}}},
\end{equation}
\begin{equation}
\label{eq_rec_4}
ADC_{\rm{R}}=\frac{E_{\rm{R}}}{E_0}\cdot MIP_{\rm{I}}\cdot e^{\frac{-(L-z)}{A_{\rm{L}}}},
\end{equation}
where $E_{L/R}$ is half the energy deposited by the particle in the left/right paddle and $E_0$ is given by Eq.~\ref{eq_def_e0}.
The above equations are valid for hits in the left paddles, while for hits in the right paddles, the applicable equations are obtained by switching the $L/R$ indices.
From Eqs.~\ref{eq_rec_3} and \ref{eq_rec_4} follow the relations:
\begin{equation}
E_{\rm{L}}=\frac{ADC_{\rm{L}} \cdot E_0}{MIP_{\rm{D}}}\cdot e^{\frac{z}{A_{\rm{L}}}},
\end{equation}
\begin{equation}
E_{\rm{R}}=\frac{ADC_{\rm{R}} \cdot E_0}{MIP_{\rm{I}}}\cdot e^{\frac{L-z}{A_{\rm{R}}}}.
\end{equation}
The total deposited energy is given by the sum of $E_{\rm{L}}$ and $E_{\rm{R}}$:
\begin{equation}
E_{\rm{dep}}=E_{\rm{L}}+E_{\rm{R}}.
\end{equation}

\subsection{Hit position and time reconstrution}
The reconstruction of the time and position of a hit will be shown for the case of a hit in the left paddle. In case of a hit in the right paddle the applicable equations are obtained by switching the $L/R$ indices.

Starting from $t_{\rm{L}}$ and $t_{\rm{R}}$, defined in Eq.~\ref{eq_time_hit_lr} and substracting the time offsets obtained from the calibrations, the start time and the time jitter, one can define the propagation times $t_{\rm{L}_{\rm{prop}}}$ and $t_{\rm{R}_{\rm{prop}}}$ as:
\begin{equation}
t_{\rm{L}_{\rm{prop}}}=t_{\rm{tof}}+\frac{z}{v_{\rm{eff}_{\rm{L}}}},
\end{equation}
\begin{equation}
t_{\rm{R}_{\rm{prop}}}=t_{\rm{tof}}-\frac{z}{v_{\rm{eff}_{\rm{L}}}}+\frac{L}{v_{\rm{eff}_{\rm{L}}}}+\frac{L}{v_{\rm{eff}_{\rm{R}}}}+u_{\rm{t}}.
\end{equation}

The position of the hit is then obtained as the difference of the propagation times:
\begin{equation}
%z=\frac{v_{\rm{eff}_{\rm{L}}}}{2} \left(t_{\rm{L}_{\rm{prop}}}-t_{\rm{R}_{\rm{prop}}}+ L \cdot \left(\frac{1}{v_{\rm{eff}_{\rm{L}}}}+\frac{1}{v_{\rm{eff}_{\rm{R}}}}\right)  +u_{t}\right).
z=\frac{v_{\rm{eff}_{\rm{L}}}}{2} \left(t_{\rm{L}_{\rm{prop}}}-t_{\rm{R}_{\rm{prop}}}+ L \cdot \left(\frac{1}{v_{\rm{eff}_{\rm{L}}}}+\frac{1}{v_{\rm{eff}_{\rm{R}}}}\right)  +u_{\rm{t}}\right).
\end{equation}

The $x$ and $y$ coordinates of the hit are obtained from the radius and the azimuthal angle of the hit, which are, in turn, determined by knowing the layer, sector, and component (left or right) of the hit. 
%\begin{equation}
%x=R \cdot cos(\phi),
%\end{equation}
%\begin{equation}
%y=R \cdot sin(\phi),
%\end{equation}
%where $R$ and $\phi$ are calculated from the layer (1 to 3, where 3 indicates the outer layer), sector (1 to 24) and component (1 for right, 2 for left paddle) coordinates of the hit as:
%\begin{equation}
%R= InnerR + (layer-0.5)h+ (layer-1)LayerGap
%\end{equation}
%\begin{equation}
%\phi=((sector-1)+ 0.25 +0.5(component-1)) \cdot \Delta_{\phi},
%\end{equation}
%where $ \Delta_{\phi} = 15Â°$ is the azymuthal coverage of a sector, $InnerR$ is the inner radius of the CND, $h$ is the radial thickness of a paddle and $LayerGap$ is the radial gap between layers. 
Finally, the time of flight of the particle that produced the hit is obtained as:
\begin{equation}
t_{\rm{tof}}= \frac{1}{2}\left(t_{\rm{L}_{\rm{prop}}}+t_{\rm{R}_{\rm{prop}}}- L \cdot \left(\frac{1}{v_{\rm{eff}_{\rm{L}}}}+\frac{1}{v_{\rm{eff}_{\rm{R}}}}\right)  -u_{\rm{t}}\right).
\end{equation}

\subsection{Hit/Track matching}
Tracks from charged particles crossing the CVT are associated to hits in the CND. This allows, for each CND hit matched with a CVT track, to calculate the position of the hit from the extrapolated track, the pathlength between the track vertex and the hit, and the path travelled in the hit paddle. This information is used in the calibration (Section~\ref{sec_cnd_calib}), as well as to veto charged particles when looking for neutrons in the CND. 
CVT tracks are extrapolated to radii corresponding to the entry point, middle point, and exit point of the track in the paddle. These points are defined as the intersections between the helix of the track and cylinders of radii corresponding to the distances between the center of the Central Detector and the three CND layers.
%In the following the entry, middle, and exit points coordinates are referred as $x_{en,m,ex}$, $y_{en,m,ex}$, and $z_{en,m,ex}$.
A CVT track and a CND hit are matched if the hit coordinates ($x$, $y$, and $z$) and the extrapolated coordinates ($x_{m}$, $y_{m}$, and $z_{m}$) verify the relations:
\begin{equation}
\mid x-x_{m} \mid < \sigma_x ,
\end{equation}
\begin{equation}
\mid y-y_{m} \mid < \sigma_y ,
\end{equation}
\begin{equation}
z_{m}  \in [-\sigma_z,L+\sigma_z],
\end{equation}
where $\sigma_z=1.5$ cm, $ L$ is the length of a paddle, and $\sigma_x$ and $\sigma_y$ are given by:

\begin{equation}
\sigma_x= \sqrt{x^{2}\frac{\sigma_{R}^{2}}{R^2}+y^{2}\sigma_{\phi}^{2}},
\end{equation}
\begin{equation}
\sigma_y= \sqrt{y^{2}\frac{\sigma_{R}^{2}}{R^2}+x^{2}\sigma_{\phi}^{2}},
\end{equation}
where $R$ is the radius of the hit, $\sigma_R$ is half the thickness of a paddle (1.5 cm) and $\sigma_{\phi}$ is the azimuthal resolution of each paddle ($3.75^{\circ}$).
%
The path travelled by the particle in the paddle is approximated as the distance between the entry and exit points.
%\begin{equation}
%Path_{in Paddle}= \sqrt{(x_{en}-x_{ex})^{2}+(y_{en}-y_{ex})^{2}+(z_{en}-z_{ex})^{2}}.
%\end{equation}
%
The path length between the vertex and the hit is obtained from the helix parameters.
